(()=>{"use strict";var e,n={953(e,n,t){const l=window.wp.blocks,a=window.wp.i18n,s=window.wp.blockEditor,d=window.wp.components,i=window.wp.element,o=window.wp.primitives,p=window.ReactJSXRuntime,r=(0,p.jsx)(o.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,p.jsx)(o.Path,{fillRule:"evenodd",clipRule:"evenodd",d:"M5 4.5h11a.5.5 0 0 1 .5.5v11a.5.5 0 0 1-.5.5H5a.5.5 0 0 1-.5-.5V5a.5.5 0 0 1 .5-.5ZM3 5a2 2 0 0 1 2-2h11a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5Zm17 3v10.75c0 .69-.56 1.25-1.25 1.25H6v1.5h12.75a2.75 2.75 0 0 0 2.75-2.75V8H20Z"})}),c=(0,p.jsx)(o.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,p.jsx)(o.Path,{d:"M18 11.3l-1-1.1-4 4V3h-1.5v11.3L7 10.2l-1 1.1 6.2 5.8 5.8-5.8zm.5 3.7v3.5h-13V15H4v5h16v-5h-1.5z"})}),m=window.wp.apiFetch;var h=t.n(m);const u=JSON.parse('{"UU":"telex/block-permanent-plugin-theme-downloader"}');(0,l.registerBlockType)(u.UU,{edit:function(){const e=(0,s.useBlockProps)(),[n,t]=(0,i.useState)([]),[l,o]=(0,i.useState)([]),[m,u]=(0,i.useState)([]),[g,w]=(0,i.useState)(!0),[x,v]=(0,i.useState)(!1),[_,j]=(0,i.useState)(null),[N,f]=(0,i.useState)(null),y=()=>{w(!0),j(null),h()({path:"/pptd/v1/items"}).then(e=>{t(e.plugins||[]),o(e.themes||[]),w(!1)}).catch(e=>{j(e.message||(0,a.__)("Failed to load plugins and themes","permanent-plugin-theme-downloader")),w(!1)})},b=()=>{h()({path:"/pptd/v1/log"}).then(e=>{u(e.log||[])}).catch(e=>{console.error("Failed to load update log:",e)})};(0,i.useEffect)(()=>{y(),b()},[]);const P=e=>{if("string"==typeof e&&e)try{const n=document.createElement("textarea");n.value=e,n.style.position="fixed",n.style.left="-9999px",n.style.top="-9999px",document.body.appendChild(n),n.focus(),n.select();const t=document.execCommand("copy");document.body.removeChild(n),t?(f(e),j(null),setTimeout(()=>f(null),2e3)):j((0,a.__)("Unable to copy URL. Please copy it manually.","permanent-plugin-theme-downloader"))}catch(e){console.error("Copy failed:",e),j((0,a.__)("Unable to copy URL. Please copy it manually.","permanent-plugin-theme-downloader"))}else j((0,a.__)("Invalid URL","permanent-plugin-theme-downloader"))};return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(s.InspectorControls,{children:(0,p.jsxs)(d.PanelBody,{title:(0,a.__)("Settings","permanent-plugin-theme-downloader"),children:[(0,p.jsx)(d.Button,{variant:"secondary",onClick:y,disabled:g||x,style:{marginBottom:"12px",width:"100%"},children:g?(0,a.__)("Refreshing...","permanent-plugin-theme-downloader"):(0,a.__)("Refresh List","permanent-plugin-theme-downloader")}),(0,p.jsx)(d.Button,{variant:"primary",onClick:()=>{v(!0),j(null),h()({path:"/pptd/v1/regenerate",method:"POST"}).then(()=>{v(!1),y(),b()}).catch(e=>{j(e.message||(0,a.__)("Failed to regenerate ZIP files","permanent-plugin-theme-downloader")),v(!1)})},disabled:g||x,style:{width:"100%"},children:x?(0,a.__)("Regenerating...","permanent-plugin-theme-downloader"):(0,a.__)("Regenerate All ZIPs","permanent-plugin-theme-downloader")}),(0,p.jsx)("p",{style:{marginTop:"12px",fontSize:"13px",color:"#757575"},children:(0,a.__)('ZIP files are automatically created and stored in wp-content/pptd-downloads/. They update automatically when plugins or themes are updated. Click "Regenerate" to manually update all ZIP files.',"permanent-plugin-theme-downloader")})]})}),(0,p.jsxs)("div",{...e,children:[(0,p.jsxs)("div",{className:"pptd-header",children:[(0,p.jsx)("h3",{children:(0,a.__)("Permanent Download URLs","permanent-plugin-theme-downloader")}),(0,p.jsx)("p",{className:"pptd-description",children:(0,a.__)("ZIP files are stored in wp-content/pptd-downloads/ with permanent URLs that automatically serve the latest version when updated.","permanent-plugin-theme-downloader")}),N&&(0,p.jsx)(d.Notice,{status:"success",isDismissible:!1,className:"pptd-notice",children:(0,a.__)("URL copied to clipboard!","permanent-plugin-theme-downloader")})]}),(g||x)&&(0,p.jsxs)("div",{className:"pptd-loading",children:[(0,p.jsx)(d.Spinner,{}),(0,p.jsx)("p",{children:x?(0,a.__)("Regenerating ZIP files...","permanent-plugin-theme-downloader"):(0,a.__)("Loading plugins and themes...","permanent-plugin-theme-downloader")})]}),_&&(0,p.jsx)(d.Notice,{status:"error",isDismissible:!1,children:_}),!g&&!x&&!_&&(0,p.jsx)(d.TabPanel,{className:"pptd-tabs",activateByIndex:0,tabs:[{name:"downloads",title:(0,a.__)("Downloads","permanent-plugin-theme-downloader"),className:"pptd-tab-downloads"},{name:"log",title:(0,a.__)("Update Log","permanent-plugin-theme-downloader"),className:"pptd-tab-log"}],children:e=>(0,p.jsxs)("div",{className:"pptd-tab-content",children:["downloads"===e.name&&(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("div",{className:"pptd-section",children:[(0,p.jsxs)("h4",{className:"pptd-section-title",children:[(0,a.__)("Plugins","permanent-plugin-theme-downloader")," (",n.length,")"]}),0===n.length?(0,p.jsx)("p",{className:"pptd-empty",children:(0,a.__)("No plugins found.","permanent-plugin-theme-downloader")}):(0,p.jsx)("div",{className:"pptd-list",children:n.map(e=>(0,p.jsxs)("div",{className:"pptd-item",children:[(0,p.jsxs)("div",{className:"pptd-item-info",children:[(0,p.jsx)("strong",{className:"pptd-item-name",children:e.name}),(0,p.jsxs)("span",{className:"pptd-item-version",children:["v",e.version]}),e.zip_exists?(0,p.jsx)("code",{className:"pptd-item-url",children:e.url}):(0,p.jsx)("span",{className:"pptd-item-error",children:(0,a.__)("ZIP creation failed","permanent-plugin-theme-downloader")})]}),(0,p.jsx)("div",{className:"pptd-item-actions",children:e.zip_exists&&(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(d.Button,{icon:r,label:(0,a.__)("Copy URL","permanent-plugin-theme-downloader"),onClick:()=>P(e.url),className:N===e.url?"pptd-copied":""}),(0,p.jsx)(d.Button,{icon:c,label:(0,a.__)("Download","permanent-plugin-theme-downloader"),href:e.url,download:!0})]})})]},e.slug))})]}),(0,p.jsxs)("div",{className:"pptd-section",children:[(0,p.jsxs)("h4",{className:"pptd-section-title",children:[(0,a.__)("Themes","permanent-plugin-theme-downloader")," (",l.length,")"]}),0===l.length?(0,p.jsx)("p",{className:"pptd-empty",children:(0,a.__)("No themes found.","permanent-plugin-theme-downloader")}):(0,p.jsx)("div",{className:"pptd-list",children:l.map(e=>(0,p.jsxs)("div",{className:"pptd-item",children:[(0,p.jsxs)("div",{className:"pptd-item-info",children:[(0,p.jsx)("strong",{className:"pptd-item-name",children:e.name}),(0,p.jsxs)("span",{className:"pptd-item-version",children:["v",e.version]}),e.zip_exists?(0,p.jsx)("code",{className:"pptd-item-url",children:e.url}):(0,p.jsx)("span",{className:"pptd-item-error",children:(0,a.__)("ZIP creation failed","permanent-plugin-theme-downloader")})]}),(0,p.jsx)("div",{className:"pptd-item-actions",children:e.zip_exists&&(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(d.Button,{icon:r,label:(0,a.__)("Copy URL","permanent-plugin-theme-downloader"),onClick:()=>P(e.url),className:N===e.url?"pptd-copied":""}),(0,p.jsx)(d.Button,{icon:c,label:(0,a.__)("Download","permanent-plugin-theme-downloader"),href:e.url,download:!0})]})})]},e.slug))})]})]}),"log"===e.name&&(0,p.jsxs)("div",{className:"pptd-log-section",children:[(0,p.jsxs)("div",{className:"pptd-log-header",children:[(0,p.jsx)("h4",{children:(0,a.__)("Update History","permanent-plugin-theme-downloader")}),(0,p.jsx)("p",{className:"pptd-log-description",children:(0,a.__)("Automatic log of all plugin and theme updates. ZIP files are regenerated each time an update occurs.","permanent-plugin-theme-downloader")})]}),0===m.length?(0,p.jsx)("p",{className:"pptd-empty",children:(0,a.__)("No updates recorded yet.","permanent-plugin-theme-downloader")}):(0,p.jsx)("div",{className:"pptd-log-list",children:m.map((e,n)=>{return(0,p.jsxs)("div",{className:"pptd-log-entry",children:[(0,p.jsx)("div",{className:"pptd-log-icon",children:"plugin"===e.type?"ðŸ”Œ":"ðŸŽ¨"}),(0,p.jsxs)("div",{className:"pptd-log-info",children:[(0,p.jsxs)("div",{className:"pptd-log-name",children:[(0,p.jsx)("strong",{children:e.name}),(0,p.jsx)("span",{className:"pptd-log-type",children:e.type})]}),(0,p.jsxs)("div",{className:"pptd-log-versions",children:[(0,p.jsxs)("span",{className:"pptd-log-old-version",children:["v",e.old_version]}),(0,p.jsx)("span",{className:"pptd-log-arrow",children:"â†’"}),(0,p.jsxs)("span",{className:"pptd-log-new-version",children:["v",e.new_version]})]}),(0,p.jsx)("div",{className:"pptd-log-timestamp",children:(t=e.timestamp,new Date(t).toLocaleString())})]})]},n);var t})})]})]})})]})]})},save:()=>null})}},t={};function l(e){var a=t[e];if(void 0!==a)return a.exports;var s=t[e]={exports:{}};return n[e](s,s.exports,l),s.exports}l.m=n,e=[],l.O=(n,t,a,s)=>{if(!t){var d=1/0;for(r=0;r<e.length;r++){for(var[t,a,s]=e[r],i=!0,o=0;o<t.length;o++)(!1&s||d>=s)&&Object.keys(l.O).every(e=>l.O[e](t[o]))?t.splice(o--,1):(i=!1,s<d&&(d=s));if(i){e.splice(r--,1);var p=a();void 0!==p&&(n=p)}}return n}s=s||0;for(var r=e.length;r>0&&e[r-1][2]>s;r--)e[r]=e[r-1];e[r]=[t,a,s]},l.n=e=>{var n=e&&e.__esModule?()=>e.default:()=>e;return l.d(n,{a:n}),n},l.d=(e,n)=>{for(var t in n)l.o(n,t)&&!l.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:n[t]})},l.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),(()=>{var e={57:0,350:0};l.O.j=n=>0===e[n];var n=(n,t)=>{var a,s,[d,i,o]=t,p=0;if(d.some(n=>0!==e[n])){for(a in i)l.o(i,a)&&(l.m[a]=i[a]);if(o)var r=o(l)}for(n&&n(t);p<d.length;p++)s=d[p],l.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return l.O(r)},t=globalThis.webpackChunkblock_permanent_plugin_theme_downloader=globalThis.webpackChunkblock_permanent_plugin_theme_downloader||[];t.forEach(n.bind(null,0)),t.push=n.bind(null,t.push.bind(t))})();var a=l.O(void 0,[350],()=>l(953));a=l.O(a)})();